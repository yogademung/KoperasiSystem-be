generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native","windows","debian-openssl-1.0.x","debian-openssl-1.1.x","debian-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id              Int             @id @default(autoincrement()) @map("USER_ID")
  username        String          @unique @map("LOGIN") @db.VarChar(50)
  password        String          @map("PWD") @db.VarChar(255)
  fullName        String          @map("NAMA") @db.VarChar(100)
  staffId         String?         @map("STAFF_ID") @db.VarChar(50)
  roleId          Int?            @map("ROLE_LPD_ID")
  regionCode      String?         @map("WILAYAH_CD") @db.VarChar(20)
  token           String?         @map("TOKEN") @db.Text
  isActive        Boolean         @default(true) @map("ACTIVE_FLAG")
  createdBy       String?         @map("CREATE_WHO") @db.VarChar(50)
  createdAt       DateTime        @default(now()) @map("CREATE_DATE")
  updatedBy       String?         @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt       DateTime?       @updatedAt @map("CHANGE_DATE")
  isTotpEnabled   Boolean         @default(false) @map("IS_TOTP_ENABLED")
  totpSecret      String?         @map("TOTP_SECRET") @db.VarChar(100)
  role            Role?           @relation(fields: [roleId], references: [id])
  monthEndLogs    MonthEndLog[]
  periodLocks     PeriodLock[]    @relation("PeriodLocker")
  periodUnlocks   PeriodLock[]    @relation("PeriodUnlocker")
  postedJournals  PostedJournal[]
  unlockApprovals UnlockRequest[] @relation("UnlockApprover")
  unlockRequests  UnlockRequest[] @relation("UnlockRequester")
  collectorShifts CollectorShift[]

  @@index([roleId], map: "s_user_lpd_ROLE_LPD_ID_fkey")
  @@map("s_user_lpd")
}

model Role {
  id          Int        @id @default(autoincrement()) @map("ROLE_LPD_ID")
  roleName    String     @map("nama_role") @db.VarChar(100)
  description String?    @map("deskripsi") @db.Text
  isActive    Boolean    @default(true) @map("ACTIVE_FLAG")
  createdBy   String?    @map("CREATE_WHO") @db.VarChar(50)
  createdAt   DateTime   @default(now()) @map("CREATE_DATE")
  updatedBy   String?    @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt   DateTime?  @updatedAt @map("CHANGE_DATE")
  menuRoles   MenuRole[]
  users       User[]

  @@map("s_role_lpd")
}

model Menu {
  id        Int        @id @default(autoincrement()) @map("menu_lpd_id")
  menuName  String     @map("nama_menu") @db.VarChar(100)
  module    String?    @map("modul") @db.VarChar(50)
  node      String?    @map("node") @db.VarChar(10)
  parentId  Int?       @map("parent_id")
  icon      String?    @map("icon") @db.VarChar(50)
  path      String?    @map("path") @db.VarChar(255)
  orderNum  Int?       @map("order_num")
  isActive  Boolean    @default(true) @map("ACTIVE_FLAG")
  createdBy String?    @map("CREATE_WHO") @db.VarChar(50)
  createdAt DateTime   @default(now()) @map("CREATE_DATE")
  updatedBy String?    @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt DateTime?  @updatedAt @map("CHANGE_DATE")
  menuRoles MenuRole[]

  @@map("s_menu_lpd")
}

model MenuRole {
  roleId    Int     @map("ROLE_LPD_ID")
  menuId    Int     @map("menu_lpd_id")
  canCreate Boolean @default(false) @map("can_create")
  canRead   Boolean @default(true) @map("can_read")
  canUpdate Boolean @default(false) @map("can_update")
  canDelete Boolean @default(false) @map("can_delete")
  role      Role    @relation(fields: [roleId], references: [id])
  menu      Menu    @relation(fields: [menuId], references: [id])

  @@id([roleId, menuId])
  @@index([menuId], map: "s_menu_role_lpd_menu_lpd_id_fkey")
  @@map("s_menu_role_lpd")
}

model LovValue {
  code        String    @map("CODE") @db.VarChar(50)
  codeValue   String    @map("CODE_VAL") @db.VarChar(50)
  description String?   @map("DESCRIPTION") @db.VarChar(255)
  orderNum    Int?      @map("ORDER_NUM")
  isActive    Boolean   @default(true) @map("ACTIVE_FLAG")
  createdBy   String?   @map("CREATE_WHO") @db.VarChar(50)
  createdAt   DateTime  @default(now()) @map("CREATE_DATE")
  updatedBy   String?   @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt   DateTime? @updatedAt @map("CHANGE_DATE")

  @@id([code, codeValue])
  @@map("s_lov_value")
}

model ProductConfig {
  id                  Int      @id @default(autoincrement())
  productCode         String   @unique @map("product_code") @db.VarChar(50)
  productName         String   @map("product_name") @db.VarChar(100)
  tableName           String   @map("table_name") @db.VarChar(100)
  isEnabled           Boolean  @default(true) @map("is_enabled")
  isCore              Boolean  @default(false) @map("is_core")
  displayOrder        Int      @map("display_order")
  routePath           String   @map("route_path") @db.VarChar(255)
  icon                String?  @db.VarChar(50)
  
  // Interest Rate Configuration
  defaultInterestRate Decimal? @map("default_interest_rate") @db.Decimal(5, 2)
  minInterestRate     Decimal? @map("min_interest_rate") @db.Decimal(5, 2)
  maxInterestRate     Decimal? @map("max_interest_rate") @db.Decimal(5, 2)
  
  createdAt           DateTime @default(now()) @map("created_at")
  updatedAt           DateTime @updatedAt @map("updated_at")

  @@map("s_product_config")
}

model Nasabah {
  id           Int                 @id @default(autoincrement()) @map("NASABAH_ID")
  nama         String              @map("NAMA") @db.VarChar(255)
  noKtp        String?             @unique @map("NO_KTP") @db.VarChar(50)
  alamat       String?             @map("ALAMAT") @db.Text
  email        String?             @map("EMAIL") @db.VarChar(100)
  telepon      String?             @map("TELEPON") @db.VarChar(20)
  tempatLahir  String?             @map("TEMPAT_LAHIR") @db.VarChar(100)
  tanggalLahir DateTime?           @map("TANGGAL_LAHIR") @db.Date
  jenisKelamin String?             @map("JENIS_KELAMIN") @db.VarChar(1)
  pekerjaan    String?             @map("PEKERJAAN") @db.VarChar(100)
  fileKtp      String?             @map("FILE_KTP") @db.VarChar(255)
  fileKk       String?             @map("FILE_KK") @db.VarChar(255)
  isActive     Boolean             @default(true) @map("ACTIVE_FLAG")
  createdBy    String?             @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime            @default(now()) @map("CREATE_DATE")
  updatedBy    String?             @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt    DateTime?           @updatedAt @map("CHANGE_DATE")
  collaterals  Collateral[]
  kredit       DebiturKredit[]
  anggota      AnggotaAccount[]
  balimesari   NasabahBalimesari[]
  brahmacari   NasabahBrahmacari[]
  deposito     NasabahJangka[]
  modal        NasabahModal[]
  tabungan     NasabahTab[]
  wanaprasta   NasabahWanaprasta[]
  waris        NasabahWaris[]

  @@map("m_nasabah")
}

model AnggotaAccount {
  accountNumber String               @id @map("NO_ANGGOTA") @db.VarChar(20)
  customerId    Int                  @map("NASABAH_ID")
  principal     Decimal              @map("POKOK") @db.Decimal(19, 4)
  mandatoryInit Decimal              @map("WAJIB_AWAL") @db.Decimal(19, 4)
  openDate      DateTime             @map("TGL_DAFTAR") @db.Date
  closeDate     DateTime?            @map("TGL_TUTUP") @db.Date
  balance       Decimal              @default(0.0000) @map("SALDO") @db.Decimal(19, 4)
  status        String               @default("D") @map("STATUS") @db.VarChar(2)
  regionCode    String               @map("WILAYAH_CD") @db.VarChar(45)
  groupCode     String               @map("GROUP_CD") @db.VarChar(10)
  remark        String?              @map("REMARK") @db.Text
  deduction     Decimal              @default(0.0000) @map("POTONGAN") @db.Decimal(19, 4)
  isActive      Boolean              @default(true) @map("ACTIVE_FLAG")
  createdBy     String               @map("CREATE_WHO") @db.VarChar(50)
  createdAt     DateTime             @default(now()) @map("CREATE_DATE")
  customer      Nasabah              @relation(fields: [customerId], references: [id])
  transactions  AnggotaTransaction[]

  @@index([customerId], map: "m_nasabah_anggota_NASABAH_ID_fkey")
  @@map("m_nasabah_anggota")
}

model NasabahTab {
  noTab        String     @id @map("NO_TAB") @db.VarChar(50)
  nasabahId    Int        @map("NASABAH_ID")
  tglBuka      DateTime   @map("TGL_BUKA") @db.Date
  saldo        Decimal    @default(0.0000) @map("SALDO") @db.Decimal(19, 4)
  interestRate Decimal    @default(0.00) @map("BUNGA_PCT") @db.Decimal(5, 2)
  status       String     @default("A") @map("STATUS") @db.VarChar(10)
  createdBy    String?    @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime   @default(now()) @map("CREATE_DATE")
  updatedBy    String?    @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt    DateTime?  @updatedAt @map("CHANGE_DATE")
  nasabah      Nasabah    @relation(fields: [nasabahId], references: [id])
  transactions TransTab[]

  @@index([nasabahId], map: "m_nasabah_tab_NASABAH_ID_fkey")
  @@map("m_nasabah_tab")
}

model NasabahJangka {
  noJangka        String        @id @map("NO_JANGKA") @db.VarChar(50)
  nasabahId       Int           @map("NASABAH_ID")
  tglBuka         DateTime      @map("TGL_BUKA") @db.Date
  tglJatuhTempo   DateTime      @map("END_DATE") @db.Date
  nominal         Decimal       @map("NOMINAL") @db.Decimal(19, 4)
  bunga           Decimal       @map("BUNGA") @db.Decimal(5, 2)
  payoutMode      String        @default("MATURITY") @map("PAYOUT_MODE") @db.VarChar(20)
  targetAccountId String?       @map("TARGET_ACCOUNT_ID") @db.VarChar(50)
  status          String        @default("A") @map("STATUS") @db.VarChar(10)
  createdBy       String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt       DateTime      @default(now()) @map("CREATE_DATE")
  updatedBy       String?       @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt       DateTime?     @updatedAt @map("CHANGE_DATE")
  nasabah         Nasabah       @relation(fields: [nasabahId], references: [id])
  transactions    TransJangka[]

  @@index([nasabahId], map: "m_nasabah_jangka_NASABAH_ID_fkey")
  @@map("m_nasabah_jangka")
}

model NasabahBrahmacari {
  noBrahmacari String            @id @map("NO_BRAHMACARI") @db.VarChar(50)
  nasabahId    Int               @map("NASABAH_ID")
  tglBuka      DateTime          @map("TGL_BUKA") @db.Date
  saldo        Decimal           @default(0.0000) @map("SALDO") @db.Decimal(19, 4)
  interestRate Decimal           @default(0.00) @map("BUNGA_PCT") @db.Decimal(5, 2)
  status       String            @default("A") @map("STATUS") @db.VarChar(10)
  createdBy    String?           @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime          @default(now()) @map("CREATE_DATE")
  updatedBy    String?           @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt    DateTime?         @updatedAt @map("CHANGE_DATE")
  nasabah      Nasabah           @relation(fields: [nasabahId], references: [id])
  transactions TransBrahmacari[]

  @@index([nasabahId], map: "m_nasabah_brahmacari_NASABAH_ID_fkey")
  @@map("m_nasabah_brahmacari")
}

model NasabahBalimesari {
  noBalimesari String            @id @map("NO_BALIMESARI") @db.VarChar(50)
  nasabahId    Int               @map("NASABAH_ID")
  tglBuka      DateTime          @map("TGL_BUKA") @db.Date
  saldo        Decimal           @default(0.0000) @map("SALDO") @db.Decimal(19, 4)
  interestRate Decimal           @default(0.00) @map("BUNGA_PCT") @db.Decimal(5, 2)
  status       String            @default("A") @map("STATUS") @db.VarChar(10)
  createdBy    String?           @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime          @default(now()) @map("CREATE_DATE")
  updatedBy    String?           @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt    DateTime?         @updatedAt @map("CHANGE_DATE")
  nasabah      Nasabah           @relation(fields: [nasabahId], references: [id])
  transactions TransBalimesari[]

  @@index([nasabahId], map: "m_nasabah_balimesari_NASABAH_ID_fkey")
  @@map("m_nasabah_balimesari")
}

model NasabahWanaprasta {
  noWanaprasta String            @id @map("NO_WANAPRASTA") @db.VarChar(50)
  nasabahId    Int               @map("NASABAH_ID")
  tglBuka      DateTime          @map("TGL_BUKA") @db.Date
  saldo        Decimal           @default(0.0000) @map("SALDO") @db.Decimal(19, 4)
  interestRate Decimal           @default(0.00) @map("BUNGA_PCT") @db.Decimal(5, 2)
  status       String            @default("A") @map("STATUS") @db.VarChar(10)
  createdBy    String?           @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime          @default(now()) @map("CREATE_DATE")
  updatedBy    String?           @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt    DateTime?         @updatedAt @map("CHANGE_DATE")
  nasabah      Nasabah           @relation(fields: [nasabahId], references: [id])
  transactions TransWanaprasta[]

  @@index([nasabahId], map: "m_nasabah_wanaprasta_NASABAH_ID_fkey")
  @@map("m_nasabah_wanaprasta")
}

model NasabahWaris {
  id        Int       @id @default(autoincrement()) @map("WARIS_ID")
  nasabahId Int       @map("NASABAH_ID")
  namaWaris String    @map("NAMA_WARIS") @db.VarChar(255)
  hubungan  String    @map("HUBUNGAN") @db.VarChar(50)
  alamat    String?   @map("ALAMAT") @db.Text
  telepon   String?   @map("TELEPON") @db.VarChar(20)
  createdBy String?   @map("CREATE_WHO") @db.VarChar(50)
  createdAt DateTime  @default(now()) @map("CREATE_DATE")
  updatedBy String?   @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt DateTime? @updatedAt @map("CHANGE_DATE")
  nasabah   Nasabah   @relation(fields: [nasabahId], references: [id])

  @@index([nasabahId], map: "m_nasabah_waris_NASABAH_ID_fkey")
  @@map("m_nasabah_waris")
}

model DebiturKredit {
  id               Int                @id @default(autoincrement()) @map("DEBITUR_KREDIT_ID")
  nasabahId        Int                @map("NASABAH_ID")
  nomorKredit      String?            @unique @map("NOMOR_KREDIT") @db.VarChar(50)
  jenisKredit      String             @map("JENIS_KREDIT") @db.VarChar(50)
  tujuanKredit     String?            @map("TUJUAN_KREDIT") @db.Text
  nominalPengajuan Decimal            @map("NOMINAL_PENGAJUAN") @db.Decimal(19, 4)
  status           String             @default("OPEN") @map("STATUS") @db.VarChar(20)
  tglPengajuan     DateTime           @map("TGL_PENGAJUAN") @db.Date
  createdBy        String?            @map("CREATE_WHO") @db.VarChar(50)
  createdAt        DateTime           @default(now()) @map("CREATE_DATE")
  updatedBy        String?            @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt        DateTime?          @updatedAt @map("CHANGE_DATE")
  metodeAngsuran   String?            @map("METODE_ANGSURAN") @db.VarChar(20)
  mohonJangkaWaktu Int?               @map("MOHON_JANGKA_WAKTU")
  mohonSukuBunga   Decimal?           @map("MOHON_SUKU_BUNGA") @db.Decimal(5, 2)
  noPermohonan     String?            @unique @map("NO_PERMOHONAN") @db.VarChar(50)
  sistemBunga      String?            @map("SISTEM_BUNGA") @db.VarChar(20)
  fasilitas        DebiturFasilitas[]
  jadwal           DebiturJadwal[]
  nasabah          Nasabah            @relation(fields: [nasabahId], references: [id])
  realisasi        DebiturRealisasi[]
  analysis         CreditAnalysis?
  collaterals      KreditCollateral[]
  transactions     TransKredit[]

  @@index([nasabahId], map: "m_debitur_kredit_NASABAH_ID_fkey")
  @@map("m_debitur_kredit")
}

model DebiturFasilitas {
  id              Int           @id @default(autoincrement()) @map("FASILITAS_ID")
  debiturKreditId Int           @map("DEBITUR_KREDIT_ID")
  nominal         Decimal       @map("NOMINAL") @db.Decimal(19, 4)
  bunga           Decimal       @map("BUNGA") @db.Decimal(5, 2)
  jangkaWaktu     Int           @map("JANGKA_WAKTU")
  angsuranPokok   Decimal       @map("ANGSURAN_POKOK") @db.Decimal(19, 4)
  angsuranBunga   Decimal       @map("ANGSURAN_BUNGA") @db.Decimal(19, 4)
  createdBy       String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt       DateTime      @default(now()) @map("CREATE_DATE")
  updatedBy       String?       @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt       DateTime?     @updatedAt @map("CHANGE_DATE")
  debiturKredit   DebiturKredit @relation(fields: [debiturKreditId], references: [id])

  @@index([debiturKreditId], map: "m_debitur_fasilitas_DEBITUR_KREDIT_ID_fkey")
  @@map("m_debitur_fasilitas")
}

model DebiturJadwal {
  id              Int           @id @default(autoincrement()) @map("JADWAL_ID")
  debiturKreditId Int           @map("DEBITUR_KREDIT_ID")
  angsuranKe      Int           @map("ANGSURAN_KE")
  tglJatuhTempo   DateTime      @map("TGL_JATUH_TEMPO") @db.Date
  pokok           Decimal       @map("POKOK") @db.Decimal(19, 4)
  bunga           Decimal       @map("BUNGA") @db.Decimal(19, 4)
  total           Decimal       @map("TOTAL_ANGSURAN") @db.Decimal(19, 4)
  sisaPokok       Decimal       @map("SISA_POKOK") @db.Decimal(19, 4)
  status          String        @default("UNPAID") @map("STATUS") @db.VarChar(20)
  tglBayar        DateTime?     @map("TGL_BAYAR") @db.Date
  createdBy       String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt       DateTime      @default(now()) @map("CREATE_DATE")
  updatedBy       String?       @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt       DateTime?     @updatedAt @map("CHANGE_DATE")
  sisaBunga       Decimal       @default(0.0000) @map("SISA_BUNGA") @db.Decimal(19, 4)
  debiturKredit   DebiturKredit @relation(fields: [debiturKreditId], references: [id])

  @@index([debiturKreditId], map: "m_debitur_jadwal_DEBITUR_KREDIT_ID_fkey")
  @@map("m_debitur_jadwal")
}

model DebiturRealisasi {
  id               Int           @id @default(autoincrement()) @map("REALISASI_ID")
  debiturKreditId  Int           @map("DEBITUR_KREDIT_ID")
  tglRealisasi     DateTime      @map("TGL_REALISASI") @db.Date
  nominalRealisasi Decimal       @map("NOMINAL_REALISASI") @db.Decimal(19, 4)
  rekening         String?       @map("REKENING") @db.VarChar(50)
  createdBy        String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt        DateTime      @default(now()) @map("CREATE_DATE")
  updatedBy        String?       @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt        DateTime?     @updatedAt @map("CHANGE_DATE")
  debiturKredit    DebiturKredit @relation(fields: [debiturKreditId], references: [id])

  @@index([debiturKreditId], map: "m_debitur_realisasi_DEBITUR_KREDIT_ID_fkey")
  @@map("m_debitur_realisasi")
}

model CreditAnalysis {
  id              Int           @id @default(autoincrement()) @map("ANALISA_ID")
  debiturKreditId Int           @unique @map("DEBITUR_KREDIT_ID")
  characterScore  Int           @map("POINT_CHARACTER")
  characterDesc   String?       @map("URAIAN_CHARACTER") @db.Text
  capitalScore    Int           @map("POINT_CAPITAL")
  capitalDesc     String?       @map("URAIAN_CAPITAL") @db.Text
  capacityScore   Int           @map("POINT_CAPASITY")
  capacityDesc    String?       @map("URAIAN_CAPASITY") @db.Text
  conditionScore  Int           @map("POINT_CONDISION")
  conditionDesc   String?       @map("URAIAN_CONDISION") @db.Text
  collateralScore Int           @map("POINT_COLATERAL")
  collateralDesc  String?       @map("URAIAN_COLATERAL") @db.Text
  totalScore      Int           @map("SCORE")
  recommendation  String?       @map("REKOMENDASI") @db.Text
  createdBy       String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt       DateTime      @default(now()) @map("CREATE_DATE")
  updatedBy       String?       @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt       DateTime?     @updatedAt @map("CHANGE_DATE")
  debiturKredit   DebiturKredit @relation(fields: [debiturKreditId], references: [id])

  @@map("m_kredit_analisa")
}

model Collateral {
  id            Int                @id @default(autoincrement()) @map("COLATERAL_ID")
  nasabahId     Int                @map("NASABAH_ID")
  type          String             @map("JENIS_JAMINAN")
  description   String?            @map("KETERANGAN") @db.Text
  marketValue   Decimal            @map("NILAI_PASAR") @db.Decimal(19, 4)
  assessedValue Decimal            @map("NILAI_TAKASI") @db.Decimal(19, 4)
  details       String?            @map("DETAIL_DATA") @db.LongText
  photos        String?            @map("PHOTOS") @db.Text
  status        String             @default("ACTIVE") @map("STATUS")
  createdBy     String?            @map("CREATE_WHO") @db.VarChar(50)
  createdAt     DateTime           @default(now()) @map("CREATE_DATE")
  updatedBy     String?            @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt     DateTime?          @updatedAt @map("CHANGE_DATE")
  nasabah       Nasabah            @relation(fields: [nasabahId], references: [id])
  links         KreditCollateral[]

  @@index([nasabahId], map: "m_debitur_colateral_NASABAH_ID_fkey")
  @@map("m_debitur_colateral")
}

model KreditCollateral {
  creditId     Int           @map("DEBITUR_KREDIT_ID")
  collateralId Int           @map("COLATERAL_ID")
  collateral   Collateral    @relation(fields: [collateralId], references: [id])
  credit       DebiturKredit @relation(fields: [creditId], references: [id])

  @@id([creditId, collateralId])
  @@index([collateralId], map: "m_kredit_colateral_COLATERAL_ID_fkey")
  @@map("m_kredit_colateral")
}

model Asset {
  id                         Int                        @id @default(autoincrement()) @map("ASSET_ID")
  name                       String                     @map("NAMA_AKTIVA")
  code                       String                     @unique @map("NO_AKTIVA")
  type                       String                     @map("JENIS_AKTIVA")
  acquisitionDate            DateTime                   @map("TGL_PEROLEHAN")
  acquisitionCost            Decimal                    @map("NILAI_PEROLEHAN") @db.Decimal(19, 4)
  residualValue              Decimal                    @map("NILAI_RESIDU") @db.Decimal(19, 4)
  usefulLifeYears            Int                        @map("MASA_MANFAAT")
  depreciationRate           Float                      @map("PCT_PENYUSUTAN")
  depreciationMethod         String                     @map("METODE_PENYUSUTAN")
  assetAccountId             String                     @map("ACCOUNT_AKTIVA")
  accumDepreciationAccountId String                     @map("ACCOUNT_AKUM_PENY")
  expenseAccountId           String                     @map("ACCOUNT_BIAYA_PENY")
  status                     String                     @default("ACTIVE") @map("STATUS")
  createdBy                  String?                    @map("CREATE_WHO") @db.VarChar(50)
  createdAt                  DateTime                   @default(now()) @map("CREATE_DATE")
  updatedBy                  String?                    @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt                  DateTime?                  @updatedAt @map("CHANGE_DATE")
  depreciationHistory        AssetDepreciationHistory[]

  @@map("m_aktiva")
}

model AssetDepreciationHistory {
  id        Int            @id @default(autoincrement()) @map("HISTORY_ID")
  assetId   Int            @map("ASSET_ID")
  period    String         @map("PERIODE")
  amount    Decimal        @map("NOMINAL") @db.Decimal(19, 4)
  journalId Int?           @map("JOURNAL_ID")
  createdAt DateTime       @default(now()) @map("CREATE_DATE")
  asset     Asset          @relation(fields: [assetId], references: [id])
  journal   PostedJournal? @relation(fields: [journalId], references: [id])

  @@index([assetId], map: "t_aktiva_penyusutan_ASSET_ID_fkey")
  @@index([journalId], map: "t_aktiva_penyusutan_JOURNAL_ID_fkey")
  @@map("t_aktiva_penyusutan")
}

model JournalAccount {
  accountCode    String                @id @map("ACCOUNT_CD") @db.VarChar(20)
  accountName    String                @map("ACCOUNT_NAME") @db.VarChar(255)
  accountType    String                @map("ACCOUNT_TYPE") @db.VarChar(50)
  parentCode     String?               @map("PARENT_CD") @db.VarChar(20)
  debetPoleFlag  Boolean               @default(true) @map("DEBET_POLE_FLAG")
  remark         String?               @map("REMARK") @db.Text
  wilayahCd      String?               @map("WILAYAH_CD") @db.VarChar(10)
  isActive       Boolean               @default(true) @map("ACTIVE_FLAG")
  createdBy      String?               @map("CREATE_WHO") @db.VarChar(50)
  createdAt      DateTime              @default(now()) @map("CREATE_DATE")
  updatedBy      String?               @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt      DateTime?             @updatedAt @map("CHANGE_DATE")
  creditMappings ProductCoaMapping[]   @relation("CreditMapping")
  debitMappings  ProductCoaMapping[]   @relation("DebitMapping")
  journalDetails PostedJournalDetail[]

  @@map("m_journal_account")
}

model PostedJournal {
  id            Int                        @id @default(autoincrement()) @map("JOURNAL_ID")
  journalNumber String                     @unique @map("JOURNAL_NO") @db.VarChar(30)
  journalDate   DateTime                   @map("TGL_POSTING") @db.Date
  description   String?                    @map("KETERANGAN") @db.Text
  postingType   String                     @default("AUTO") @map("POSTING_TYPE") @db.VarChar(10)
  transType     String?                    @map("TRANS_TYPE") @db.VarChar(30)
  refId         Int?                       @map("REF_ID")
  userId        Int                        @map("USER_ID")
  tellerId      String?                    @map("TELLER_ID") @db.VarChar(20)
  wilayahCd     String?                    @map("WILAYAH_CD") @db.VarChar(10)
  status        String                     @default("POSTED") @map("STATUS") @db.VarChar(20)
  createdBy     String?                    @map("CREATE_WHO") @db.VarChar(50)
  createdAt     DateTime                   @default(now()) @map("CREATE_DATE")
  updatedBy     String?                    @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt     DateTime?                  @updatedAt @map("CHANGE_DATE")
  sourceCode    String?                    @map("SOURCE_CODE") @db.VarChar(20)
  assetHistory  AssetDepreciationHistory[]
  user          User                       @relation(fields: [userId], references: [id])
  details       PostedJournalDetail[]

  @@index([userId], map: "t_posted_journal_USER_ID_fkey")
  @@map("t_posted_journal")
}

model PostedJournalDetail {
  id          Int            @id @default(autoincrement()) @map("DETAIL_ID")
  journalId   Int            @map("JOURNAL_ID")
  accountCode String         @map("ACCOUNT_CD") @db.VarChar(20)
  debit       Decimal        @default(0.0000) @map("DEBIT") @db.Decimal(19, 4)
  credit      Decimal        @default(0.0000) @map("CREDIT") @db.Decimal(19, 4)
  description String?        @map("KETERANGAN") @db.Text
  account     JournalAccount @relation(fields: [accountCode], references: [accountCode])
  journal     PostedJournal  @relation(fields: [journalId], references: [id], onDelete: Cascade)

  @@index([accountCode], map: "t_posted_journal_detail_ACCOUNT_CD_fkey")
  @@index([journalId], map: "t_posted_journal_detail_JOURNAL_ID_fkey")
  @@map("t_posted_journal_detail")
}

model PostedJournalTemp {
  id            Int                       @id @default(autoincrement()) @map("TEMP_ID")
  originalId    Int                       @map("ORIGINAL_JOURNAL_ID")
  journalNumber String                    @map("JOURNAL_NO") @db.VarChar(30)
  journalDate   DateTime                  @map("TGL_POSTING") @db.Date
  description   String?                   @map("KETERANGAN") @db.Text
  postingType   String                    @map("POSTING_TYPE") @db.VarChar(10)
  transType     String?                   @map("TRANS_TYPE") @db.VarChar(30)
  sourceCode    String?                   @map("SOURCE_CODE") @db.VarChar(20)
  refId         Int?                      @map("REF_ID")
  userId        Int                       @map("USER_ID")
  wilayahCd     String?                   @map("WILAYAH_CD") @db.VarChar(10)
  status        String                    @map("STATUS") @db.VarChar(20)
  deletedBy     String?                   @map("DELETE_WHO") @db.VarChar(50)
  deletedAt     DateTime                  @default(now()) @map("DELETE_DATE")
  deleteReason  String?                   @map("DELETE_REASON") @db.Text
  details       PostedJournalDetailTemp[]

  @@map("t_posted_journal_temp")
}

model PostedJournalDetailTemp {
  id            Int               @id @default(autoincrement()) @map("TEMP_DETAIL_ID")
  tempJournalId Int               @map("TEMP_JOURNAL_ID")
  accountCode   String            @map("ACCOUNT_CD") @db.VarChar(20)
  debit         Decimal           @default(0.0000) @map("DEBIT") @db.Decimal(19, 4)
  credit        Decimal           @default(0.0000) @map("CREDIT") @db.Decimal(19, 4)
  description   String?           @map("KETERANGAN") @db.Text
  journal       PostedJournalTemp @relation(fields: [tempJournalId], references: [id], onDelete: Cascade)

  @@index([tempJournalId], map: "t_posted_journal_detail_temp_TEMP_JOURNAL_ID_fkey")
  @@map("t_posted_journal_detail_temp")
}

model ProductCoaMapping {
  id            Int            @id @default(autoincrement()) @map("MAPPING_ID")
  module        String         @map("MODULE") @db.VarChar(20)
  transType     String         @unique @map("TRANS_TYPE") @db.VarChar(30)
  description   String         @map("DESCRIPTION") @db.VarChar(100)
  debitAccount  String         @map("DEBIT_ACCOUNT_CD") @db.VarChar(20)
  creditAccount String         @map("CREDIT_ACCOUNT_CD") @db.VarChar(20)
  updatedAt     DateTime       @updatedAt @map("CHANGE_DATE")
  creditRef     JournalAccount @relation("CreditMapping", fields: [creditAccount], references: [accountCode])
  debitRef      JournalAccount @relation("DebitMapping", fields: [debitAccount], references: [accountCode])

  @@index([creditAccount], map: "m_product_coa_mapping_CREDIT_ACCOUNT_CD_fkey")
  @@index([debitAccount], map: "m_product_coa_mapping_DEBIT_ACCOUNT_CD_fkey")
  @@map("m_product_coa_mapping")
}

model AnggotaTransaction {
  id            Int            @id @default(autoincrement()) @map("TRANS_ID")
  accountNumber String         @map("NO_ANGGOTA") @db.VarChar(20)
  transDate     DateTime       @map("TGL_TRANS")
  transType     String         @map("TIPE_TRANS") @db.VarChar(20)
  amount        Decimal        @map("NOMINAL") @db.Decimal(19, 4)
  balanceAfter  Decimal        @map("SALDO_AKHIR") @db.Decimal(19, 4)
  description   String?        @map("KETERANGAN") @db.Text
  userId        Int            @map("USER_ID")
  latitude      Decimal?       @map("LATITUDE") @db.Decimal(10, 8)
  longitude     Decimal?       @map("LONGITUDE") @db.Decimal(10, 8)
  createdAt     DateTime       @default(now()) @map("CREATE_DATE")
  account       AnggotaAccount @relation(fields: [accountNumber], references: [accountNumber])

  @@index([accountNumber], map: "t_trans_anggota_NO_ANGGOTA_fkey")
  @@map("t_trans_anggota")
}

model TransTab {
  id         Int        @id @default(autoincrement()) @map("TRANS_ID")
  noTab      String     @map("NO_TAB") @db.VarChar(50)
  tipeTrans  String     @map("TIPE_TRANS") @db.VarChar(10)
  nominal    Decimal    @map("NOMINAL") @db.Decimal(19, 4)
  saldoAkhir Decimal    @map("SALDO_AKHIR") @db.Decimal(19, 4)
  keterangan String?    @map("KETERANGAN") @db.Text
  latitude   Decimal?   @map("LATITUDE") @db.Decimal(10, 8)
  longitude  Decimal?   @map("LONGITUDE") @db.Decimal(10, 8)
  createdBy  String?    @map("CREATE_WHO") @db.VarChar(50)
  createdAt  DateTime   @default(now()) @map("CREATE_DATE")
  tabungan   NasabahTab @relation(fields: [noTab], references: [noTab])

  @@index([noTab], map: "t_trans_tab_NO_TAB_fkey")
  @@map("t_trans_tab")
}

model TransJangka {
  id         Int           @id @default(autoincrement()) @map("TRANS_ID")
  noJangka   String        @map("NO_JANGKA") @db.VarChar(50)
  tipeTrans  String        @map("TIPE_TRANS") @db.VarChar(10)
  nominal    Decimal       @map("NOMINAL") @db.Decimal(19, 4)
  keterangan String?       @map("KETERANGAN") @db.Text
  latitude   Decimal?      @map("LATITUDE") @db.Decimal(10, 8)
  longitude  Decimal?      @map("LONGITUDE") @db.Decimal(10, 8)
  createdBy  String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt  DateTime      @default(now()) @map("CREATE_DATE")
  deposito   NasabahJangka @relation(fields: [noJangka], references: [noJangka])

  @@index([noJangka], map: "t_trans_jangka_NO_JANGKA_fkey")
  @@map("t_trans_jangka")
}

model TransBrahmacari {
  id           Int               @id @default(autoincrement()) @map("TRANS_ID")
  noBrahmacari String            @map("NO_BRAHMACARI") @db.VarChar(50)
  tipeTrans    String            @map("TIPE_TRANS") @db.VarChar(10)
  nominal      Decimal           @map("NOMINAL") @db.Decimal(19, 4)
  saldoAkhir   Decimal           @map("SALDO_AKHIR") @db.Decimal(19, 4)
  keterangan   String?           @map("KETERANGAN") @db.Text
  latitude     Decimal?          @map("LATITUDE") @db.Decimal(10, 8)
  longitude    Decimal?          @map("LONGITUDE") @db.Decimal(10, 8)
  createdBy    String?           @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime          @default(now()) @map("CREATE_DATE")
  brahmacari   NasabahBrahmacari @relation(fields: [noBrahmacari], references: [noBrahmacari])

  @@index([noBrahmacari], map: "t_trans_brahmacari_NO_BRAHMACARI_fkey")
  @@map("t_trans_brahmacari")
}

model TransBalimesari {
  id           Int               @id @default(autoincrement()) @map("TRANS_ID")
  noBalimesari String            @map("NO_BALIMESARI") @db.VarChar(50)
  tipeTrans    String            @map("TIPE_TRANS") @db.VarChar(10)
  nominal      Decimal           @map("NOMINAL") @db.Decimal(19, 4)
  saldoAkhir   Decimal           @map("SALDO_AKHIR") @db.Decimal(19, 4)
  keterangan   String?           @map("KETERANGAN") @db.Text
  latitude     Decimal?          @map("LATITUDE") @db.Decimal(10, 8)
  longitude    Decimal?          @map("LONGITUDE") @db.Decimal(10, 8)
  createdBy    String?           @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime          @default(now()) @map("CREATE_DATE")
  balimesari   NasabahBalimesari @relation(fields: [noBalimesari], references: [noBalimesari])

  @@index([noBalimesari], map: "t_trans_balimesari_NO_BALIMESARI_fkey")
  @@map("t_trans_balimesari")
}

model TransWanaprasta {
  id           Int               @id @default(autoincrement()) @map("TRANS_ID")
  noWanaprasta String            @map("NO_WANAPRASTA") @db.VarChar(50)
  tipeTrans    String            @map("TIPE_TRANS") @db.VarChar(10)
  nominal      Decimal           @map("NOMINAL") @db.Decimal(19, 4)
  saldoAkhir   Decimal           @map("SALDO_AKHIR") @db.Decimal(19, 4)
  keterangan   String?           @map("KETERANGAN") @db.Text
  latitude     Decimal?          @map("LATITUDE") @db.Decimal(10, 8)
  longitude    Decimal?          @map("LONGITUDE") @db.Decimal(10, 8)
  createdBy    String?           @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime          @default(now()) @map("CREATE_DATE")
  wanaprasta   NasabahWanaprasta @relation(fields: [noWanaprasta], references: [noWanaprasta])

  @@index([noWanaprasta], map: "t_trans_wanaprasta_NO_WANAPRASTA_fkey")
  @@map("t_trans_wanaprasta")
}

model TransKredit {
  id              Int           @id @default(autoincrement()) @map("TRANS_ID")
  debiturKreditId Int           @map("DEBITUR_KREDIT_ID")
  tipeTrans       String        @map("TIPE_TRANS") @db.VarChar(10)
  nominal         Decimal       @map("NOMINAL") @db.Decimal(19, 4)
  keterangan      String?       @map("KETERANGAN") @db.Text
  createdBy       String?       @map("CREATE_WHO") @db.VarChar(50)
  createdAt       DateTime      @default(now()) @map("CREATE_DATE")
  bungaBayar      Decimal?      @default(0.0000) @map("BUNGA_BAYAR") @db.Decimal(19, 4)
  dendaBayar      Decimal?      @default(0.0000) @map("DENDA_BAYAR") @db.Decimal(19, 4)
  journalId       Int?          @map("JOURNAL_ID")
  pokokBayar      Decimal?      @default(0.0000) @map("POKOK_BAYAR") @db.Decimal(19, 4)
  tglTrans        DateTime      @default(now()) @map("TGL_TRANS") @db.Date
  latitude        Decimal?      @map("LATITUDE") @db.Decimal(10, 8)
  longitude       Decimal?      @map("LONGITUDE") @db.Decimal(10, 8)
  kredit          DebiturKredit @relation(fields: [debiturKreditId], references: [id])

  @@index([debiturKreditId], map: "t_trans_kredit_DEBITUR_KREDIT_ID_fkey")
  @@map("t_trans_kredit")
}

model ReportTemplate {
  id             Int                   @id @default(autoincrement()) @map("TEMPLATE_ID")
  code           String                @unique @map("TEMPLATE_CODE") @db.VarChar(20)
  name           String                @map("TEMPLATE_NAME") @db.VarChar(255)
  description    String?               @map("DESCRIPTION") @db.Text
  productModule  String                @map("PRODUCT_MODULE") @db.VarChar(50)
  category       String                @map("CATEGORY") @db.VarChar(50)
  jsonSchema     String                @map("JSON_SCHEMA") @db.LongText
  paperSize      String                @default("A4") @map("PAPER_SIZE") @db.VarChar(20)
  orientation    String                @default("portrait") @map("ORIENTATION") @db.VarChar(20)
  customWidth    Decimal?              @map("CUSTOM_WIDTH") @db.Decimal(10, 2)
  customHeight   Decimal?              @map("CUSTOM_HEIGHT") @db.Decimal(10, 2)
  marginTop      Decimal               @default(20.00) @map("MARGIN_TOP") @db.Decimal(10, 2)
  marginBottom   Decimal               @default(20.00) @map("MARGIN_BOTTOM") @db.Decimal(10, 2)
  marginLeft     Decimal               @default(20.00) @map("MARGIN_LEFT") @db.Decimal(10, 2)
  marginRight    Decimal               @default(20.00) @map("MARGIN_RIGHT") @db.Decimal(10, 2)
  version        Int                   @default(1) @map("VERSION")
  isDefault      Boolean               @default(false) @map("IS_DEFAULT")
  isActive       Boolean               @default(true) @map("ACTIVE_FLAG")
  parentId       Int?                  @map("PARENT_ID")
  createdBy      String?               @map("CREATE_WHO") @db.VarChar(50)
  createdAt      DateTime              @default(now()) @map("CREATE_DATE")
  updatedBy      String?               @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt      DateTime?             @updatedAt @map("CHANGE_DATE")
  generationLogs ReportGenerationLog[]
  parent         ReportTemplate?       @relation("TemplateVersions", fields: [parentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  versions       ReportTemplate[]      @relation("TemplateVersions")

  @@index([parentId], map: "report_template_PARENT_ID_fkey")
  @@map("report_template")
}

model ReportVariable {
  id            Int       @id @default(autoincrement()) @map("VARIABLE_ID")
  productModule String    @map("PRODUCT_MODULE") @db.VarChar(50)
  variableKey   String    @map("VARIABLE_KEY") @db.VarChar(100)
  variableName  String    @map("VARIABLE_NAME") @db.VarChar(255)
  dataType      String    @map("DATA_TYPE") @db.VarChar(20)
  category      String    @map("CATEGORY") @db.VarChar(50)
  description   String?   @map("DESCRIPTION") @db.Text
  sampleValue   String?   @map("SAMPLE_VALUE") @db.VarChar(255)
  isArray       Boolean   @default(false) @map("IS_ARRAY")
  formatOptions String?   @map("FORMAT_OPTIONS") @db.LongText
  createdAt     DateTime  @default(now()) @map("CREATE_DATE")
  updatedAt     DateTime? @updatedAt @map("CHANGE_DATE")

  @@unique([productModule, variableKey])
  @@map("report_variable")
}

model ReportGenerationLog {
  id           Int            @id @default(autoincrement()) @map("LOG_ID")
  templateId   Int            @map("TEMPLATE_ID")
  recordId     String?        @map("RECORD_ID") @db.VarChar(100)
  format       String         @map("FORMAT") @db.VarChar(10)
  parameters   String?        @map("PARAMETERS") @db.LongText
  status       String         @map("STATUS") @db.VarChar(20)
  errorMessage String?        @map("ERROR_MESSAGE") @db.Text
  filePath     String?        @map("FILE_PATH") @db.VarChar(500)
  fileSize     Int?           @map("FILE_SIZE")
  generatedBy  String?        @map("GENERATED_BY") @db.VarChar(50)
  generatedAt  DateTime       @default(now()) @map("GENERATED_DATE")
  template     ReportTemplate @relation(fields: [templateId], references: [id])

  @@index([templateId], map: "report_generation_log_TEMPLATE_ID_fkey")
  @@map("report_generation_log")
}

model PassbookPrintState {
  id                 Int      @id @default(autoincrement()) @map("STATE_ID")
  accountNumber      String   @unique @map("ACCOUNT_NUMBER") @db.VarChar(50)
  productType        String   @map("PRODUCT_TYPE") @db.VarChar(50)
  lastPrintedTransId Int?     @map("LAST_PRINTED_TRANS_ID")
  lastPrintedLine    Int      @default(1) @map("LAST_PRINTED_LINE")
  totalLinesPrinted  Int      @default(0) @map("TOTAL_LINES_PRINTED")
  updatedAt          DateTime @updatedAt @map("LAST_PRINT_DATE")

  @@map("passbook_print_state")
}

model NasabahModal {
  noRekModal   String       @id @map("NO_REK_MODAL") @db.VarChar(50)
  nasabahId    Int          @map("NASABAH_ID")
  tglBuka      DateTime     @map("TGL_BUKA") @db.Date
  saldo        Decimal      @default(0.0000) @map("SALDO") @db.Decimal(19, 4)
  status       String       @default("A") @map("STATUS") @db.VarChar(10)
  wilayahCd    String?      @map("WILAYAH_CD") @db.VarChar(10)
  createdBy    String?      @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime     @default(now()) @map("CREATE_DATE")
  updatedBy    String?      @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt    DateTime?    @updatedAt @map("CHANGE_DATE")
  nasabah      Nasabah      @relation(fields: [nasabahId], references: [id])
  transactions TransModal[]

  @@index([nasabahId], map: "m_nasabah_modal_NASABAH_ID_fkey")
  @@map("m_nasabah_modal")
}

model TransModal {
  id           Int          @id @default(autoincrement()) @map("TRANS_ID")
  noRekModal   String       @map("NO_REK_MODAL") @db.VarChar(50)
  tipeTrans    String       @map("TIPE_TRANS") @db.VarChar(10)
  transDate    DateTime     @default(now()) @map("TGL_TRANS") @db.Date
  nominal      Decimal      @map("NOMINAL") @db.Decimal(19, 4)
  saldoAkhir   Decimal      @map("SALDO_AKHIR") @db.Decimal(19, 4)
  keterangan   String?      @map("KETERANGAN") @db.Text
  journalId    Int?         @map("JOURNAL_ID")
  latitude     Decimal?     @map("LATITUDE") @db.Decimal(10, 8)
  longitude    Decimal?     @map("LONGITUDE") @db.Decimal(10, 8)
  createdBy    String?      @map("CREATE_WHO") @db.VarChar(50)
  createdAt    DateTime     @default(now()) @map("CREATE_DATE")
  nasabahModal NasabahModal @relation(fields: [noRekModal], references: [noRekModal])

  @@index([noRekModal], map: "t_trans_modal_NO_REK_MODAL_fkey")
  @@map("t_trans_modal")
}

model ExternalLoan {
  id                   Int                   @id @default(autoincrement()) @map("LOAN_ID")
  bankName             String                @map("BANK_NAME") @db.VarChar(100)
  contractNumber       String                @map("CONTRACT_NUMBER") @db.VarChar(50)
  loanDate             DateTime              @map("LOAN_DATE") @db.Date
  maturityDate         DateTime              @map("MATURITY_DATE") @db.Date
  principal            Decimal               @map("PRINCIPAL") @db.Decimal(19, 4)
  interestRate         Decimal               @map("INTEREST_RATE") @db.Decimal(5, 2)
  termMonths           Int                   @map("TERM_MONTHS")
  installmentType      String                @map("INSTALLMENT_TYPE") @db.VarChar(20)
  monthlyInstallment   Decimal               @map("MONTHLY_INSTALLMENT") @db.Decimal(19, 4)
  outstandingPrincipal Decimal               @map("OUTSTANDING_PRINCIPAL") @db.Decimal(19, 4)
  status               String                @default("ACTIVE") @map("STATUS") @db.VarChar(20)
  createdBy            String?               @map("CREATE_WHO") @db.VarChar(50)
  createdAt            DateTime              @default(now()) @map("CREATE_DATE")
  updatedBy            String?               @map("CHANGE_WHO") @db.VarChar(50)
  updatedAt            DateTime?             @updatedAt @map("CHANGE_DATE")
  schedule             InstallmentSchedule[]

  @@map("m_pinjaman_external")
}

model InstallmentSchedule {
  id                Int          @id @default(autoincrement()) @map("SCHEDULE_ID")
  loanId            Int          @map("LOAN_ID")
  installmentNumber Int          @map("INSTALLMENT_NUMBER")
  dueDate           DateTime     @map("DUE_DATE") @db.Date
  principalDue      Decimal      @map("PRINCIPAL_DUE") @db.Decimal(19, 4)
  interestDue       Decimal      @map("INTEREST_DUE") @db.Decimal(19, 4)
  totalDue          Decimal      @map("TOTAL_DUE") @db.Decimal(19, 4)
  status            String       @default("DUE") @map("STATUS") @db.VarChar(20)
  paidDate          DateTime?    @map("PAID_DATE") @db.Date
  loan              ExternalLoan @relation(fields: [loanId], references: [id])

  @@index([loanId], map: "t_jadwal_pinjaman_external_LOAN_ID_fkey")
  @@map("t_jadwal_pinjaman_external")
}

model PeriodLock {
  period       String          @id @map("PERIODE") @db.VarChar(7)
  status       String          @map("STATUS") @db.VarChar(20)
  reason       String?         @map("REASON") @db.Text
  lockedAt     DateTime        @map("LOCKED_AT")
  lockedBy     Int             @map("LOCKED_BY")
  unlockedAt   DateTime?       @map("UNLOCKED_AT")
  unlockedBy   Int?            @map("UNLOCKED_BY")
  unlockReason String?         @map("UNLOCK_REASON") @db.Text
  creator      User            @relation("PeriodLocker", fields: [lockedBy], references: [id])
  unlocker     User?           @relation("PeriodUnlocker", fields: [unlockedBy], references: [id])
  requests     UnlockRequest[]

  @@index([lockedBy], map: "t_period_lock_LOCKED_BY_fkey")
  @@index([unlockedBy], map: "t_period_lock_UNLOCKED_BY_fkey")
  @@map("t_period_lock")
}

model UnlockRequest {
  id           Int        @id @default(autoincrement()) @map("REQUEST_ID")
  period       String     @map("PERIODE") @db.VarChar(7)
  requestedBy  Int        @map("REQUESTED_BY")
  requestedAt  DateTime   @default(now()) @map("REQUESTED_AT")
  reason       String     @map("REASON") @db.Text
  status       String     @default("PENDING") @map("STATUS") @db.VarChar(20)
  approvedBy   Int?       @map("APPROVED_BY")
  approvedAt   DateTime?  @map("APPROVED_AT")
  managerNotes String?    @map("MANAGER_NOTES") @db.Text
  approver     User?      @relation("UnlockApprover", fields: [approvedBy], references: [id])
  periodLock   PeriodLock @relation(fields: [period], references: [period])
  requester    User       @relation("UnlockRequester", fields: [requestedBy], references: [id])

  @@index([approvedBy], map: "t_unlock_request_APPROVED_BY_fkey")
  @@index([period], map: "t_unlock_request_PERIODE_fkey")
  @@index([requestedBy], map: "t_unlock_request_REQUESTED_BY_fkey")
  @@map("t_unlock_request")
}

model MonthEndLog {
  id          Int      @id @default(autoincrement()) @map("LOG_ID")
  period      String   @map("PERIODE") @db.VarChar(7)
  action      String   @map("ACTION") @db.VarChar(50)
  status      String   @map("STATUS") @db.VarChar(20)
  details     String?  @map("DETAILS") @db.Text
  performedBy Int      @map("PERFORMED_BY")
  performedAt DateTime @default(now()) @map("PERFORMED_AT")
  user        User     @relation(fields: [performedBy], references: [id])

  @@index([performedBy], map: "t_month_end_log_PERFORMED_BY_fkey")
  @@map("t_month_end_log")
}

model CollectorShift {
  id              Int       @id @default(autoincrement()) @map("SHIFT_ID")
  userId          Int       @map("USER_ID")
  shiftDate       DateTime  @default(now()) @map("SHIFT_DATE")
  startTime       DateTime  @default(now()) @map("START_TIME")
  endTime         DateTime? @map("END_TIME")
  status          String    @default("ACTIVE") @map("STATUS") @db.VarChar(20)
  
  // Starting cash (float for change)
  startingCash    Decimal   @map("STARTING_CASH") @db.Decimal(19, 4)
  startDenom100k  Int       @default(0) @map("START_100K")
  startDenom50k   Int       @default(0) @map("START_50K")
  startDenom20k   Int       @default(0) @map("START_20K")
  startDenom10k   Int       @default(0) @map("START_10K")
  startDenom5k    Int       @default(0) @map("START_5K")
  startDenom2k    Int       @default(0) @map("START_2K")
  startDenom1k    Int       @default(0) @map("START_1K")
  startDenom500   Int       @default(0) @map("START_500")
  startDenom200   Int       @default(0) @map("START_200")
  startDenom100   Int       @default(0) @map("START_100")
  
  // Ending cash (at shift close)
  endingCash      Decimal?  @map("ENDING_CASH") @db.Decimal(19, 4)
  endDenom100k    Int?      @map("END_100K")
  endDenom50k     Int?      @map("END_50K")
  endDenom20k     Int?      @map("END_20K")
  endDenom10k     Int?      @map("END_10K")
  endDenom5k      Int?      @map("END_5K")
  endDenom2k      Int?      @map("END_2K")
  endDenom1k      Int?      @map("END_1K")
  endDenom500     Int?      @map("END_500")
  endDenom200     Int?      @map("END_200")
  endDenom100     Int?      @map("END_100")
  
  // Transaction summary during shift
  totalDeposits   Decimal   @default(0) @map("TOTAL_DEPOSITS") @db.Decimal(19, 4)
  totalWithdrawals Decimal  @default(0) @map("TOTAL_WITHDRAWALS") @db.Decimal(19, 4)
  transactionCount Int      @default(0) @map("TRANS_COUNT")
  
  // Closing journal reference
  closingJournalId Int?     @map("CLOSING_JOURNAL_ID")
  
  createdAt       DateTime  @default(now()) @map("CREATED_AT")
  updatedAt       DateTime  @updatedAt @map("UPDATED_AT")

  user            User      @relation(fields: [userId], references: [id])
  
  @@index([userId, status], map: "idx_shift_user_status")
  @@index([shiftDate], map: "idx_shift_date")
  @@map("t_collector_shift")
}
